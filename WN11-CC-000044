Author          : Luis Valdivia
    LinkedIn        : https://www.linkedin.com/in/lvaldivia123/
    GitHub          : https://github.com/Valdivialuis123
    Date Created    : 2026-20-01
    Last Modified   : 2026-20-01
    Version         : 1.0
    CVEs            : N/A
    Plugin IDs      : N/A
    STIG-ID        WN11-CC-000044
TESTED ON
    Date(s) Tested  : 
    Tested By       : 
    Systems Tested  : 
    PowerShell Ver. : PowerShell 5.1
Synopsis: Internet connection sharing makes it possible for an existing internet connection, such as through wireless, to be shared and used by other systems essentially creating a mobile hotspot. 
This exposes the system sharing the connection to others with potentially malicious purpose.

Manual solution Configure the policy value for Computer Configuration >> Administrative Templates >> Network >> Network Connections 
>> 'Prohibit use of Internet Connection Sharing on your DNS domain network' to 'Enabled'.

CODE
Write-Host "Configuring STIG: Prohibit use of Internet Connection Sharing..." -ForegroundColor Cyan

# Registry path for the policy
$regPath = "HKLM:\SOFTWARE\Policies\Microsoft\Windows\Network Connections"

# Create the key if it doesn't exist
if (-not (Test-Path $regPath)) {
    New-Item -Path $regPath -Force | Out-Null
}

# Enable the policy (1 = Enabled)
New-ItemProperty -Path $regPath `
